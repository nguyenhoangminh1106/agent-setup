---
description: "Generate a Structured Requirement Spec from a ticket using Codex CLI. Embeds the ticket verbatim, expands it into Goals, Non-goals, Functional reqs, Constraints, Edge cases, Acceptance criteria, and Assumptions. Saves output as an artifact."
arguments:
  - name: ticket
    description: "Full ticket text, GitHub issue number, or URL describing the work to be done."
---

## Task

Use Codex CLI to generate a Structured Requirement Spec from a ticket. The ticket is embedded verbatim and is the sole source of truth. Output is saved as a reusable artifact for downstream skills (e.g. `ticket`).

## Rules

- Never invent scope.
- Never improve, reinterpret, or expand the ticket beyond what is stated.
- If something is unclear, document the uncertainty — do not guess.
- Ticket text is authoritative.

## Steps

**1) Fetch ticket if needed**

If `{{ticket}}` is a GitHub issue number or URL:
```bash
gh issue view {{ticket}} --json title,body,labels,assignees
```
Use the returned title + body as the ticket text. Otherwise use `{{ticket}}` as-is.

**2) Switch to Codex CLI**

Invoke Codex with the ticket embedded verbatim:

```bash
codex "You are a requirements analyst. Given the following ticket, produce a Structured Requirement Spec.

TICKET (verbatim):
---
{{ticket}}
---

Output the spec in this exact format with no deviations:

## Goals
What the ticket wants to achieve.

## Non-goals
What is explicitly out of scope.

## Functional requirements
Observable behaviors the implementation must produce.

## Non-functional requirements
Performance, accessibility, compatibility constraints.

## Constraints
Tech stack, file limits, must-not-touch areas.

## Edge cases
Boundary conditions and failure modes mentioned or implied.

## Acceptance criteria
Conditions under which the ticket is considered done.

## Assumptions
Anything inferred that is not stated — flag every assumption explicitly with [ASSUMPTION].

Rules:
- Never invent scope.
- If something is unclear, document the uncertainty instead of guessing.
- Ticket text is authoritative. Do not reinterpret it."
```

**3) Save artifact**

Save the full Codex output as **SPEC_ARTIFACT** in `.claude/ticket-artifacts/spec.md`:
```bash
mkdir -p .claude/ticket-artifacts
# write Codex output to:
.claude/ticket-artifacts/spec.md
```

**4) Display**

Print the full spec to the user.

If Codex is unavailable: generate the spec in-process using the same format and rules. Prepend a warning: `[FALLBACK: Codex unavailable — spec generated by current agent]`.
